from ali_dataset import ALiData
from train import trainModel
from utils.utils import setup_seed
import torch
import numpy as np
import random

def SetSeed():
    # 设置随机种子
    setup_seed(42)
    torch_state_seed_value = torch.initial_seed()
    print("Torch Random Seed:", torch_state_seed_value)

    rng_state = np.random.get_state()
    rng_state_seed_value = rng_state[1][0]
    print("NumPy Random Seed:", rng_state_seed_value)

    random_state = random.getstate()
    random_state_seed_value = random_state[1][0]
    print("Python Random Seed:", random_state_seed_value)

if __name__ == "__main__":

    SetSeed()
    hyperparameters = {
        "learning_rate": 0.001,
        "batch_size": 32,
        "num_epochs": 5,
        "sequence_max_len":51,
        "optimizer": "Adam",
        "loss_function": "CrossEntropyLoss"
    }
    TrainDataLoader = ALiData(batch_size=hyperparameters['batch_size'], train=True, 
                            sequence_max_len=hyperparameters['sequence_max_len'])
    TestDataLoader = ALiData(batch_size=hyperparameters['batch_size'], train=False, 
                            sequence_max_len=hyperparameters['sequence_max_len'])
    
    trainModel(TrainDataLoader,TestDataLoader,hyperparameters)