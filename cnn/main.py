from mal_img_dataset import ImgData
from train import trainModel
from utils.utils import setup_seed
import torch
import numpy as np
import random

def SetSeed():
    # 设置随机种子
    setup_seed(42)
    torch_state_seed_value = torch.initial_seed()
    print("Torch Random Seed:", torch_state_seed_value)

    rng_state = np.random.get_state()
    rng_state_seed_value = rng_state[1][0]
    print("NumPy Random Seed:", rng_state_seed_value)

    random_state = random.getstate()
    random_state_seed_value = random_state[1][0]
    print("Python Random Seed:", random_state_seed_value)

if __name__ == "__main__":

    SetSeed()
    hyperparameters = {
        "learning_rate": 0.005,
        "batch_size": 64,
        "num_epochs": 5,
        "optimizer": "Adam",
        "loss_function": "CrossEntropyLoss"
    }
    TrainDataLoader = ImgData(batch_size=hyperparameters['batch_size'], train=True)
    TestDataLoader = ImgData(batch_size=hyperparameters['batch_size'], train=False)
    
    trainModel(TrainDataLoader,TestDataLoader,hyperparameters)
