from ali_dataset import ALiData
from train import trainModel
from utils.utils import setup_seed
import torch
import numpy as np
import random

def SetSeed():
    # 设置随机种子
    setup_seed(42)
    torch_state_seed_value = torch.initial_seed()
    print("Torch Random Seed:", torch_state_seed_value)

    rng_state = np.random.get_state()
    rng_state_seed_value = rng_state[1][0]
    print("NumPy Random Seed:", rng_state_seed_value)

    random_state = random.getstate()
    random_state_seed_value = random_state[1][0]
    print("Python Random Seed:", random_state_seed_value)

if __name__ == "__main__":

    SetSeed()
    hyperparameters = {
        "num_epochs": 100,
        "learning_rate": 0.001,
        "n_class":2,
        "sequence_max_len":3000,
        "start_kernel_size":1,
        "Max_kernel_size":89,
        "paramenter_number_of_layer_list":[8*128, 5*128*256 + 2*256*128],

        "batch_size": 256,
    }
    TrainDataLoader = ALiData(batch_size=hyperparameters['batch_size'], train=True, 
                            sequence_max_len=hyperparameters['sequence_max_len'])
    TestDataLoader = ALiData(batch_size=hyperparameters['batch_size'], train=False, 
                            sequence_max_len=hyperparameters['sequence_max_len'])
    
    trainModel(TrainDataLoader,TestDataLoader,hyperparameters)